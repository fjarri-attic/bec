\documentclass[12pt,notitlepage]{report}
\usepackage{indentfirst}
\usepackage[pdftex]{graphicx}
\usepackage{subfig}

\author{Bogdan Opanchuk}

\begin{document}

The steady state obtained using Thomas-Fermi approximation is good for estimation purposes, but not for
real-life calculations - for example, it does not have continuous first derivative everywhere (namely,
near the edges of the condensate). That is why we have to employ numerical calculations in order
to find precise (to a certain extent) solution of the Shrodinger equation. One of the possible methods, 
namely combination of split-step Fourier method and imaginary time, will be described in this section.

Let us say we have the system with Hamiltonian $\hat{H}$, whose eigenvalues are $E_1 < E_2 < ...$.
The steady state we want to find is the one with lowest energy ($E_1$). The steady solution of time-dependent
Shrodinger equation
\[ -i \hbar \frac{\partial \psi}{\partial t} = \hat{H} \psi \]
then looks like
\[ \psi(\mathbf{r}, t) = \sum_i e^{\frac{i}{h} E_i t} f_i(\mathbf{r}) \]
We can use Hamiltonian to propagate the solution in time:
\[ 
\psi(t + dt) \simeq \psi(t) + \frac{\partial \psi}{\partial t} dt = \\
\psi(t) + \frac{dt}{-i \hbar} \hat{H} \psi(t)
\]

Now consider the substitution $t \rightarrow it$; after it the steady solution will become fading, with
higher-energy components fading faster:
\[ \psi(\mathbf{r}, t) = \sum_i e^{- \frac{1}{h} E_i t} f_i(\mathbf{r}) \]
Therefore, if we take some random solution and propagate it for a sufficient amount of time, higher-energy
components will eventually die out (in comparison with the lowest-energy state) and leave us with desired 
steady state:
\[ \psi(t + dt) \simeq \psi(t) + \frac{dt}{\hbar} \hat{H} \psi(t)\]
Of course, renormalisation will be required after each step, since the precision of numerical calculations is limited.

Now how do we propagate the state of the system? There are a lot of possibilities, one of which is split-step
Fourier method. It is rather simple and can be effectively parallelised, which means a good scaling and 
low computation times. 

The propagation can be described as:
\[ -\hbar \psi(t + dt, \mathbf{r}) \simeq \exp(dt \hat{H}) \psi(t, \mathbf{r}) \]
The idea of split-step Fourier method is to separate the execution of different parts of Hamiltonian:
\begin{equation}
\label{split_step_steady_state:splitted_propagation}
-\hbar \psi(t + dt, \mathbf{r}) \simeq \exp(dt \hat{D}) \exp(dt \hat{N}) \psi(t, \mathbf{r})
\end{equation}
where $\hat{D}$ and $\hat{N}$ are chosen so that they could be executed most conveniently in Fourier and spatial
domain correspondingly. For our Hamiltonian
\[ 
\hat{H} = -\frac{\hbar^2}{2m} \frac{\partial^2}{\partial \mathbf{r}^2} + \\
V(\mathbf{r}) + g_{11} \vert \psi(\mathbf{r}) \vert^2 
\]
it means
\[ \hat{D} = -\frac{\hbar^2}{2m} \frac{\partial^2}{\partial \mathbf{r}^2} \]
\[ \hat{N} = V(\mathbf{r}) + g_{11} \vert \psi(\mathbf{r}) \vert^2 \]
The spatial derivative is a simple multiplication in Fourier domain, so the propagation can be performed 
straightforwardly:
\[ 
-\hbar \psi(t + dt, \mathbf{r}) \simeq \left\{ \hat{F}^{-1} \exp \left[ dt \hat{D}(i\omega) \right] \hat{F} \right\} \\
\exp(dt \hat{N}) \psi(t, \mathbf{r}) 
\]
Here $\hat{D}(i\omega)$ is obtained by replacing differential operator by $i \omega$, where $\omega$ is a
frequency in Fourier domain.

In order to improve the accuracy of the method, equation \ref{split_step_steady_state:splitted_propagation}
can be rewritten as
\[
-\hbar \psi(t + dt, \mathbf{r}) \simeq \exp \left( \frac{dt}{2} \hat{D} \right) \\
\exp \left( \int\limits^{t + dt}_t \hat{N} (t^\prime) dt^\prime \right) \\
\exp \left( \frac{dt}{2} \hat{D} \right) \psi(t, \mathbf{r})
\]
This method is called the symmetrized split-step Fourier method. Integral can be evaluated either by approximating it
with $dt\hat{N}$ or by using more accurate method, like trapezoidal rule
\[ \int\limits^{t + dt}_t \hat{N} (t^\prime) dt^\prime \simeq \frac{dt}{2} \left( \hat{N}(t) + \hat{N}(t + dt) \right) \]
Since the value of $\hat{N}(t + dt)$ is unknown at the time of the calculation (it is performed in the
middle of the step), an iterative procedure is necessary.

\end{document}